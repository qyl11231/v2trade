# è¿è¡Œæ—¶é”™è¯¯ä¿®å¤è¯´æ˜

> **é”™è¯¯ç±»å‹**ï¼š`NoClassDefFoundError: com/qyl/v2trade/market/calibration/util/KlineTimeCalculator`

---

## ğŸ” é”™è¯¯ä¿¡æ¯

```
java.lang.NoClassDefFoundError: com/qyl/v2trade/market/calibration/util/KlineTimeCalculator
	at com.qyl.v2trade.market.calibration.service.impl.KlineGapDetectorImpl.detectMissingTimestamps(KlineGapDetectorImpl.java:43)
```

**é”™è¯¯å‘ç”Ÿæ—¶é—´**ï¼š2026-01-12 08:22:31  
**é”™è¯¯åœºæ™¯**ï¼šæ‰‹åŠ¨æ‰§è¡Œç¼ºå¤±è¡¥å…¨Kçº¿ä»»åŠ¡

---

## ğŸ” é—®é¢˜è¯Šæ–­

### æ ¹æœ¬åŸå› 

`NoClassDefFoundError` è¡¨ç¤ºï¼š
- **ç¼–è¯‘æ—¶**ï¼šç±»æ–‡ä»¶å­˜åœ¨ï¼Œç¼–è¯‘é€šè¿‡
- **è¿è¡Œæ—¶**ï¼šæ‰¾ä¸åˆ°ç±»çš„å®šä¹‰ï¼ˆclassæ–‡ä»¶ä¸å­˜åœ¨æˆ–ç±»è·¯å¾„é—®é¢˜ï¼‰

è¿™ç§æƒ…å†µé€šå¸¸å‘ç”Ÿåœ¨ï¼š
1. æºä»£ç å·²ä¿®æ”¹ï¼Œä½†æœªé‡æ–°ç¼–è¯‘
2. ç¼–è¯‘åçš„classæ–‡ä»¶æŸåæˆ–ç¼ºå¤±
3. ç±»è·¯å¾„é…ç½®é”™è¯¯
4. åº”ç”¨æœåŠ¡å™¨ç¼“å­˜äº†æ—§çš„classæ–‡ä»¶

### éªŒè¯æ­¥éª¤

1. **æ£€æŸ¥æºä»£ç æ–‡ä»¶æ˜¯å¦å­˜åœ¨**
   ```
   æ–‡ä»¶è·¯å¾„ï¼šsrc/main/java/com/qyl/v2trade/market/calibration/util/KlineTimeCalculator.java
   ```
   âœ… å·²ç¡®è®¤ï¼šæ–‡ä»¶å­˜åœ¨

2. **æ£€æŸ¥ç¼–è¯‘åçš„classæ–‡ä»¶æ˜¯å¦å­˜åœ¨**
   ```
   æ–‡ä»¶è·¯å¾„ï¼štarget/classes/com/qyl/v2trade/market/calibration/util/KlineTimeCalculator.class
   ```
   âœ… å·²ç¡®è®¤ï¼šclassæ–‡ä»¶å­˜åœ¨

3. **æ£€æŸ¥ä»£ç å¼•ç”¨æ˜¯å¦æ­£ç¡®**
   ```java
   // KlineGapDetectorImpl.java ç¬¬7è¡Œ
   import com.qyl.v2trade.market.calibration.util.KlineTimeCalculator;
   
   // KlineGapDetectorImpl.java ç¬¬43è¡Œ
   List<Long> expectedTimestamps = KlineTimeCalculator.calculateExpectedTimestamps(
       startTimestamp, endTimestamp);
   ```
   âœ… å·²ç¡®è®¤ï¼šå¼•ç”¨æ­£ç¡®

---

## âœ… è§£å†³æ–¹æ¡ˆ

### æ–¹æ¡ˆ1ï¼šé‡æ–°ç¼–è¯‘é¡¹ç›®ï¼ˆæ¨èï¼‰

1. **ä½¿ç”¨Mavené‡æ–°ç¼–è¯‘**
   ```bash
   mvn clean compile
   # æˆ–è€…
   mvn clean package -DskipTests
   ```

2. **å¦‚æœMavenä¸åœ¨PATHä¸­**
   - ä½¿ç”¨IDEçš„ç¼–è¯‘åŠŸèƒ½ï¼ˆå¦‚IntelliJ IDEAçš„ Build > Rebuild Projectï¼‰
   - æˆ–è€…åœ¨IDEçš„Mavenå·¥å…·çª—å£ä¸­æ‰§è¡Œ `clean compile`

### æ–¹æ¡ˆ2ï¼šé‡å¯åº”ç”¨æœåŠ¡å™¨

å¦‚æœå·²ç»é‡æ–°ç¼–è¯‘ï¼Œä½†é—®é¢˜ä»ç„¶å­˜åœ¨ï¼š

1. **å®Œå…¨åœæ­¢åº”ç”¨æœåŠ¡å™¨**
2. **æ¸…ç†ç¼“å­˜**ï¼ˆå¦‚æœä½¿ç”¨IDEï¼‰
   - IntelliJ IDEA: File > Invalidate Caches / Restart
3. **é‡æ–°å¯åŠ¨åº”ç”¨æœåŠ¡å™¨**

### æ–¹æ¡ˆ3ï¼šæ£€æŸ¥ç±»è·¯å¾„é…ç½®

ç¡®ä¿é¡¹ç›®çš„ç±»è·¯å¾„é…ç½®æ­£ç¡®ï¼š

1. **æ£€æŸ¥IDEçš„é¡¹ç›®è®¾ç½®**
   - ç¡®è®¤ `src/main/java` åœ¨Source Foldersä¸­
   - ç¡®è®¤ `target/classes` åœ¨Output Foldersä¸­

2. **æ£€æŸ¥Mavené…ç½®**
   - ç¡®è®¤ `pom.xml` ä¸­çš„ç¼–è¯‘é…ç½®æ­£ç¡®
   - ç¡®è®¤ `maven-compiler-plugin` é…ç½®æ­£ç¡®

---

## ğŸ”§ å¿«é€Ÿä¿®å¤æ­¥éª¤

1. **åœæ­¢åº”ç”¨æœåŠ¡å™¨**
2. **é‡æ–°ç¼–è¯‘é¡¹ç›®**
   ```bash
   mvn clean compile
   ```
   æˆ–è€…ä½¿ç”¨IDEçš„BuildåŠŸèƒ½
3. **æ¸…ç†IDEç¼“å­˜**ï¼ˆå¯é€‰ä½†æ¨èï¼‰
   - IntelliJ IDEA: File > Invalidate Caches / Restart
4. **é‡æ–°å¯åŠ¨åº”ç”¨æœåŠ¡å™¨**
5. **é‡æ–°æ‰§è¡Œä»»åŠ¡**

---

## ğŸ“‹ éªŒè¯æ¸…å•

ä¿®å¤åï¼Œè¯·éªŒè¯ï¼š

- [ ] åº”ç”¨å¯åŠ¨æ— é”™è¯¯
- [ ] `KlineTimeCalculator` ç±»å¯ä»¥æ­£å¸¸åŠ è½½
- [ ] ç¼ºå¤±æ•°æ®æ£€æµ‹ä»»åŠ¡å¯ä»¥æ­£å¸¸æ‰§è¡Œ
- [ ] å…¶ä»–ä½¿ç”¨ `KlineTimeCalculator` çš„åŠŸèƒ½æ­£å¸¸

---

## ğŸ“ ç›¸å…³ç±»ä½¿ç”¨æƒ…å†µ

`KlineTimeCalculator` è¢«ä»¥ä¸‹ç±»ä½¿ç”¨ï¼š

1. **KlineGapDetectorImpl.java**
   - æ–¹æ³•ï¼š`detectMissingTimestamps()`
   - ä½¿ç”¨ï¼š`calculateExpectedTimestamps()`, `alignToMinuteStart()`

2. **HistoricalKlineFetcherImpl.java**
   - ä½¿ç”¨ï¼š`alignToMinuteStart()`

3. **DataVerifyExecutor.java**
   - ä½¿ç”¨ï¼š`alignToMinuteStart()`

---

## ğŸš¨ é¢„é˜²æªæ–½

ä¸ºé¿å…ç±»ä¼¼é—®é¢˜ï¼š

1. **ä¿®æ”¹ä»£ç åç«‹å³ç¼–è¯‘**
   - ä½¿ç”¨IDEçš„è‡ªåŠ¨ç¼–è¯‘åŠŸèƒ½
   - æˆ–ä½¿ç”¨ `mvn compile` æ‰‹åŠ¨ç¼–è¯‘

2. **éƒ¨ç½²å‰å®Œæ•´æµ‹è¯•**
   - ç¡®ä¿æ‰€æœ‰ä¾èµ–ç±»éƒ½å·²ç¼–è¯‘
   - æ‰§è¡Œå®Œæ•´çš„æ„å»ºæµç¨‹

3. **ä½¿ç”¨ç‰ˆæœ¬æ§åˆ¶**
   - ç¡®ä¿æºä»£ç å’Œç¼–è¯‘äº§ç‰©åŒæ­¥
   - é¿å…åªä¿®æ”¹æºä»£ç è€Œä¸ç¼–è¯‘

---

**æœ€åæ›´æ–°**ï¼š2026-01-12  
**ç»´æŠ¤äºº**ï¼šé‡åŒ–å›¢é˜Ÿæ¶æ„ç»„
